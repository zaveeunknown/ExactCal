<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Settings ‚Ä¢ Commission Calculator</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="calculator settings-wrap">
    <div class="topbar">
      <h2>Settings</h2>
      <a href="index.html">‚Üê Back to Calculator</a>
    </div>

    <div class="settings-card">
      <h3>Get the Example App-Script Code</h3>
      <p class="help">
        Download the code file:  
        <br><a href="Code.gs" download="Code.gs">‚¨áÔ∏è Download Code.gs</a>  
        <br><br>
        Open <b>script.google.com</b>, make a new project, then go to  
        <b>File ‚Üí New script file</b>. Copy + paste everything into the editor.
      </p>
    </div>

    <div class="settings-card">
      <h3>Copy the Google Sheet Template</h3>
      <p class="help">
        Open the ready-to-use Google Sheet:  
        <br><a href="https://docs.google.com/spreadsheets/d/1Uk1wQFkSSVLKM4SdcUxzx6ptva7GsXkZsvv4XnlXw30/edit?usp=sharing"
           target="_blank" rel="noopener noreferrer">üìÑ Open Template Sheet</a>
      </p>
      <p class="help">
        When it opens, click <b>File ‚Üí Make a copy</b> to save it into your Drive.
      </p>
    </div>

    <div class="settings-card">
  <h3>üîó Connect the App Script to Your Google Sheet</h3>
  <div class="help">
    <ol>
      <li>Open <b>your copy</b> of the Google Sheet you made from the template.</li>
      <li>In the sheet‚Äôs URL, copy the ID ‚Äî the long string between <code>/d/</code> and <code>/edit</code>.<br>
        <small>Example: <code>https://docs.google.com/spreadsheets/d/<b>1AbCDefGhIJKlmNOPqrsTuvWXyZ123456</b>/edit</code></small>
      </li>
	  <li>On the top bar select "Extensions" then press "Apps Scripts" </li>
	  <div class="step-image">
      <img src="images/savebuttonstep.png" alt="Save Button Step" />
      </div>
      <li>At the very top of <code>Code.gs</code>, find this line:<br>
        <pre><code>const SHEET_ID = "YOUR_ID_HERE";</code></pre>
      </li>
      <li>Replace <code>YOUR_ID_HERE</code> with the ID you copied. ‚úÖ</li>
    </ol>
  </div>
</div>

    <div class="settings-card">
      <h3>Make the Code a Web App</h3>
      <div class="help">
        <ol>
          <li>Save the script.</li>
          <li>Go to <b>Deploy ‚Üí New deployment</b>.</li>
		  <div class="step-image">
          <img src="images/newdeployment.png" alt="Save Button Step" />
          </div>
          <li>Select <b>Type: Web app</b>, set <b>Execute as: Me</b>, and <b>Access: Anyone with the link</b>.</li>
		  <div class="step-image">
          <img src="images/deploy.png" alt="Save Button Step" />
          </div>
		  <li>Deploy</li>
		  <li>Press Authorize Access and Follow the steps</li>
		  <li>when finished Copy the "Web URL"</li>
        </ol>
      </div>
    </div>

    <div class="settings-card">
      <h3>Paste the Web App URL</h3>
      <div class="settings-row">
        <label for="appsScriptUrl">Web App URL</label>
        <input type="url" id="appsScriptUrl" placeholder="https://script.google.com/macros/s/AKfyc.../exec" />
        <div class="help">
          This endpoint is used for both <b>saving rows</b> and <b>loading metrics</b>.
        </div>
      </div>

      <div class="btns">
	    <button class="btn btn-primary" id="saveBtn">Save</button>
        <button class="btn btn-secondary" id="testBtn">Test Connection</button>
        <div id="loadingMsg" class="loading" style="display:none;">‚è≥ Testing connection...</div>
      </div>

      <div id="okMsg" class="notice">‚úÖ Saved!</div>
      <div id="errMsg" class="error"></div>
      <div id="backToCalc" class="back-to-calc" style="display:none;">
        Connection ready!  
        <br><a href="index.html" class="btn btn-primary">‚Üê Go Back to Calculator</a>
      </div>
    </div>
  </div>

  <script src="app-config.js"></script>
  <script src="settings.js"></script>
</body>
</html>
